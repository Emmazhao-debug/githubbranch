{"Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.InvokeTrigger, ServerDesignerCommon","Parameters":[{"Name":"物品ID"},{"Name":"变更数"},{"Name":"出入库"}]}],"Commands":[{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon","ParamObject":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=变更数"}},"value":"0","compareType":4,"Id":"3800cb8b-9301-4d41-81ff-2a53df976164"},"CommandList":[{"$type":"Forguncy.Model.ReturnCommand, ServerDesignerCommon","ErrorCode":"1","Message":"库存变更数不能小于0"}],"ID":"5246e18e-bea4-45b9-8c6c-5099bf35a732"}],"Comments":"变更数小于0，更新失败"},{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon","ParamObject":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=变更数"}},"value":"0","compareType":2,"Id":"6cc4323b-30ed-4529-b018-c63005369bd2"},"CommandList":[{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"物品","TableValue":{"TableName":"物品表","TableValueType":1,"BindingInfos":[{"BindingInfo":{"TableName":"物品表","ColumnName":"ID"},"ColumnName":"ID"},{"BindingInfo":{"TableName":"物品表","ColumnName":"库存"},"ColumnName":"库存"},{"BindingInfo":{"TableName":"物品表","ColumnName":"名称"},"ColumnName":"名称"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"物品表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品ID"},"Id":"c10f19b3-4011-43f2-994c-c35823f97017"}},"ID":"0bed4c3443824901b5ffad858b723554","Comments":"获取物品信息"},{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"ForguncyDataAccess.RelationSqlCondition, ForguncyDataAccess","Condition1":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon","ParamObject":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库"}},"value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=5"},"Id":"93e514a7-b486-499f-9008-d96b6f56033f"},"Condition2":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon","ParamObject":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品.库存"}},"value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=变更数"},"compareType":4,"Id":"901f600e-b0bf-4362-a491-5740b4d81cf1"},"Id":"13b1aad3-2c72-409a-bcd2-ef0af987937a"},"CommandList":[{"$type":"Forguncy.Model.ReturnCommand, ServerDesignerCommon","ErrorCode":"1","Message":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品.名称&\"库存不足。\""}}],"Comments":"5代表出库","ID":"8fe447a2-52c3-42b2-8442-f4ba84b15bbb"}],"Comments":"如果是出库，检查库存是否充足"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"物品表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"物品表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品ID"},"Id":"09692638-afc1-43dd-9f62-d55bc453ddba"},"UpdateValues":[{"ColumnName":"库存","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品.库存+变更数*IF(出入库=5,-1,1)"}}],"ParamNameToSaveNewRowValue":"NewRow","Comments":"更新库存"}],"Comments":"变更数大于0，更新库存，等于0则什么都不用做","ID":"f02fbceb-69ce-4648-b7e3-7ea3e8ba2ee9"}]}],"Name":"修改物品库存"}