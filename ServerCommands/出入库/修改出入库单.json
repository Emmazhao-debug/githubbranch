{"Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon","Permission":{"AllowRoles":["库存管理员","仓库主管"]},"Parameters":[{"Name":"出入库单ID"},{"Name":"出入库"},{"Name":"日期"},{"Name":"类型"},{"Name":"客户ID"},{"Name":"其他出入库对象"},{"Name":"联系人"},{"Name":"联系电话"},{"Name":"总金额"},{"Name":"项目ID"},{"Name":"备注"},{"Type":1,"ArrayParamItems":[{"Name":"物品ID"},{"Name":"数量"},{"Name":"单价"},{"Name":"备注"}],"OnlySendChangedData":true,"PrimaryKeys":["ID"],"Name":"详情表"}]}],"Commands":[{"$type":"Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"检查是否盘点中","CheckDataValidation":true},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"出入库表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库单ID"},"Id":"23139afc-e0b0-4a77-b09b-a008f99932b1"},"UpdateValues":[{"ColumnName":"日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=日期"}},{"ColumnName":"类型","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=类型"}},{"ColumnName":"客户ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=客户ID"}},{"ColumnName":"其他出入库对象","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=其他出入库对象"}},{"ColumnName":"联系人","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系人"}},{"ColumnName":"联系电话","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系电话"}},{"ColumnName":"总金额","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=总金额"}},{"ColumnName":"项目ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=项目ID"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=备注"}}],"ParamNameToSaveNewRowValue":"出入库单"},{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"出入库反操作","ParameterValue":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=IF(出入库=5,6,5)"},"ID":"48dc568148844c21a696dd89f5c3d080","Comments":"如果原本为入库，反操作就是出库；如果原本为出库，反操作就是入库。用于删除，编辑详情。"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=详情表.AddRows"},"LoopItemParamName":"物品详情"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库详情表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"出入库ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库单ID"}},{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"}},{"ColumnName":"数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.备注"}}]},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"修改物品库存","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"},"ParamName":"物品ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"},"ParamName":"变更数"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库"},"ParamName":"出入库"}],"CheckDataValidation":true}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=详情表.EditRows"},"LoopItemParamName":"物品详情"},"CommandList":[{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"原物品详情","TableValue":{"TableName":"出入库详情表","TableValueType":1,"BindingInfos":[{"BindingInfo":{"TableName":"出入库详情表","ColumnName":"物品ID"},"ColumnName":"物品ID"},{"BindingInfo":{"TableName":"出入库详情表","ColumnName":"数量"},"ColumnName":"数量"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"出入库详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.ID"},"Id":"39c32efa-c65a-4b53-b072-e84c3cf203fa"}},"ID":"b44cfa61138743d1ab0606c1a7d6067c"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库详情表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"出入库详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.ID"},"Id":"d7cda911-4861-4548-94f4-73cfd794f24c"},"UpdateValues":[{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"}},{"ColumnName":"数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.备注"}}],"ParamNameToSaveNewRowValue":"新建详情"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"修改物品库存","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=原物品详情.物品ID"},"ParamName":"物品ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=原物品详情.数量"},"ParamName":"变更数"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库反操作"},"ParamName":"出入库"}],"CheckDataValidation":true},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"修改物品库存","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"},"ParamName":"物品ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"},"ParamName":"变更数"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库"},"ParamName":"出入库"}],"CheckDataValidation":true}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=详情表.DeleteRows"},"LoopItemParamName":"物品详情"},"CommandList":[{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"原物品详情","TableValue":{"TableName":"出入库详情表","TableValueType":1,"BindingInfos":[{"BindingInfo":{"TableName":"出入库详情表","ColumnName":"物品ID"},"ColumnName":"物品ID"},{"BindingInfo":{"TableName":"出入库详情表","ColumnName":"数量"},"ColumnName":"数量"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"出入库详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.ID"},"Id":"c6006098-4bfe-4853-b0fd-591fdeb7ebab"}},"ID":"0548f4de002742ac807da9457425c967"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库详情表","UpdateType":"delete","ShowConfirm":true,"ConfirmText":"您确定要删除吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"出入库详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.ID"},"Id":"eca696b2-a0e0-4d61-9d48-5a3656cf4b20"},"UpdateValues":[{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"}},{"ColumnName":"数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.备注"}}],"ParamNameToSaveNewRowValue":"新建详情"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"修改物品库存","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=原物品详情.物品ID"},"ParamName":"物品ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=原物品详情.数量"},"ParamName":"变更数"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库反操作"},"ParamName":"出入库"}],"CheckDataValidation":true}]}]},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"根据出入库单修改 采购单_已入库 销售单_已出库","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=其他出入库对象"},"ParamName":"采购销售单号"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=类型"},"ParamName":"出入库类型"}],"CheckDataValidation":true}],"Name":"修改出入库单"}