{"Description":"通过参数决定是否检查盘点中，结束盘点 命令也会调用","Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.InvokeTrigger, ServerDesignerCommon","Parameters":[{"Name":"出入库"},{"Name":"日期"},{"Name":"类型"},{"Name":"客户ID"},{"Name":"其他出入库对象"},{"Name":"联系人"},{"Name":"联系电话"},{"Name":"总金额"},{"Name":"项目ID"},{"Name":"备注"},{"ArrayParamItems":[{"Name":"物品ID"},{"Name":"数量"},{"Name":"单价"},{"Name":"备注"}],"PrimaryKeys":["ID"],"Name":"详情表"},{"Name":"是否检查盘点中"}]}],"Commands":[{"$type":"Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionServerSiteParam, ServerDesignerCommon","ParamObject":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=是否检查盘点中"}},"value":"1","Id":"3640515c-b37b-46cb-a6d6-4df07b88d909"},"CommandList":[{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"检查是否盘点中","CheckDataValidation":true}],"ID":"640c9384-c7e2-47c1-8e93-f33b5af1e29c"}],"Comments":"根据参数决定是否检查盘点中"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"出入库","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库"}},{"ColumnName":"日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=日期"}},{"ColumnName":"类型","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=类型"}},{"ColumnName":"客户ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=客户ID"}},{"ColumnName":"其他出入库对象","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=其他出入库对象"}},{"ColumnName":"联系人","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系人"}},{"ColumnName":"联系电话","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系电话"}},{"ColumnName":"总金额","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=总金额"}},{"ColumnName":"项目ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=项目ID"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=备注"}},{"ColumnName":"经办人","Value":"%CurrentUser%"}],"ParamNameToSaveNewRowValue":"出入库单"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=详情表"},"LoopItemParamName":"物品详情"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"出入库详情表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"出入库ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库单.ID"}},{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"}},{"ColumnName":"数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.备注"}}],"ParamNameToSaveNewRowValue":"新建详情"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"修改物品库存","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.物品ID"},"ParamName":"物品ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品详情.数量"},"ParamName":"变更数"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=出入库"},"ParamName":"出入库"}],"CheckDataValidation":true}],"Comments":"循环添加详情表并修改物品库存"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"根据出入库单修改 采购单_已入库 销售单_已出库","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=其他出入库对象"},"ParamName":"采购销售单号"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=类型"},"ParamName":"出入库类型"}],"CheckDataValidation":true}]}],"Name":"新建出入库单_私有"}