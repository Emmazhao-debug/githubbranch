{"Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon","Permission":{"AllowRoles":["采购员","采购主管"]},"Parameters":[{"Name":"订单ID"},{"Name":"采购日期"},{"Name":"供应商ID"},{"Name":"联系人"},{"Name":"联系电话"},{"Name":"交付日期"},{"Name":"项目ID"},{"Name":"采购员"},{"Name":"采购部门"},{"Name":"总金额"},{"Name":"备注"},{"Name":"交付地址"},{"Type":1,"ArrayParamItems":[{"Name":"物品ID"},{"Name":"数量"},{"Name":"单价"},{"Name":"备注"}],"OnlySendChangedData":true,"PrimaryKeys":["ID"],"Name":"采购详情"}]}],"Commands":[{"$type":"Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"采购订单表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"采购订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"ef872e4e-e181-4ec7-b703-ba123e83219d"},"UpdateValues":[{"ColumnName":"采购日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购日期"}},{"ColumnName":"供应商_客户ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=供应商ID"}},{"ColumnName":"联系人","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系人"}},{"ColumnName":"联系电话","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系电话"}},{"ColumnName":"交付日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=交付日期"}},{"ColumnName":"项目ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=项目ID"}},{"ColumnName":"采购员","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购员"}},{"ColumnName":"采购部门","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购部门"}},{"ColumnName":"总金额","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=总金额"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=备注"}},{"ColumnName":"交付地址","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=交付地址"}}],"ParamNameToSaveNewRowValue":"采购单"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购详情.AddRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"采购订单详情表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"采购订单ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"}},{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"}},{"ColumnName":"采购数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.备注"}}],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购详情.EditRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"采购订单详情表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"采购订单详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.ID"},"Id":"90789104-c76c-4125-99c5-5e650fe15859"},"UpdateValues":[{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"}},{"ColumnName":"采购数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.备注"}}],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=采购详情.DeleteRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"采购订单详情表","UpdateType":"delete","ShowConfirm":true,"ConfirmText":"您确定要删除吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"采购订单详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.ID"},"Id":"148ce775-64e7-4794-a25d-79e6524ed2c0"},"UpdateValues":[{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"}},{"ColumnName":"采购数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.备注"}}],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"新采购详情","TableValue":{"TableName":"采购订单详情表","BindingInfos":[{"BindingInfo":{"TableName":"采购订单详情表","ColumnName":"物品ID"},"ColumnName":"物品ID"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"采购订单详情表","ColumnName":"采购订单ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"0b9a245c-2f4b-4c26-85fa-29281dc46f60"}},"ID":"378ddccb1c204e05b44ee0a0eb7aa3b2"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=新采购详情"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"关联供应商客户与物品","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=供应商ID"},"ParamName":"供应商客户ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"},"ParamName":"物品ID"}],"CheckDataValidation":true}]},{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"订单号","TableValue":{"TableName":"采购订单表","OnlyGetValue":true,"TableValueType":0,"BindingInfos":[{"BindingInfo":{"TableName":"采购订单表","ColumnName":"单号"},"ColumnName":"单号"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"采购订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"043b8bd6-06f0-464c-a163-10c5acaadddb"}},"ID":"3b55937c400c476290970c6a10127672"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"更新采购单入库状态","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单号"},"ParamName":"订单号"}],"CheckDataValidation":true}]}],"Name":"修改采购单"}