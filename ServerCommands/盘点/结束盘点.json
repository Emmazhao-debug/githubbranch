{"Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon","Permission":{"AllowRoles":["库存管理员","仓库主管"]},"Parameters":[{"Name":"盘点单号"}]}],"Commands":[{"$type":"Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"盘点详情","TableValue":{"TableName":"盘点详情表","BindingInfos":[{"BindingInfo":{"TableName":"盘点详情表","ColumnName":"ID"},"ColumnName":"ID"},{"BindingInfo":{"TableName":"盘点详情表","ColumnName":"物品ID"},"ColumnName":"物品ID"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"盘点详情表","ColumnName":"盘点ID","RelationBinding":{"RelatedTable":"盘点表","RelatedColumn":"ID","DisplayColumn":"单号"}},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=盘点单号"},"Id":"eb8e1085-e184-4c06-995f-f2607649cb43"}},"ID":"94b33846a086453da671bec59ed2e24c"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=盘点详情"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"物品库存","TableValue":{"TableName":"物品表","OnlyGetValue":true,"TableValueType":0,"BindingInfos":[{"BindingInfo":{"TableName":"物品表","ColumnName":"库存"},"ColumnName":"库存"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"物品表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"},"Id":"0264860f-aa08-4938-af46-bd2cf4d39179"}},"ID":"7f12d6d3a835416ca8d94e0f94d0a1f4"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"盘点详情表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"盘点详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.ID"},"Id":"017bd77f-9dbd-4ed3-856f-585f23551e78"},"UpdateValues":[{"ColumnName":"系统数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=物品库存"}}],"ParamNameToSaveNewRowValue":"NewRow"}],"Comments":"更新盘点单中的系统数量"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"根据盘点单出入库","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=盘点单号"},"ParamName":"盘点单号"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":"盘亏","ParamName":"盘亏盘盈"}],"CheckDataValidation":true,"Comments":"盘亏出库"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"根据盘点单出入库","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=盘点单号"},"ParamName":"盘点单号"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":"盘盈","ParamName":"盘亏盘盈"}],"CheckDataValidation":true,"Comments":"盘盈入库"},{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"盘点表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"盘点表","ColumnName":"单号"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=盘点单号"},"Id":"f1d6e1e3-bbc1-4a3a-948c-526827b7fabb"},"UpdateValues":[{"ColumnName":"是否结束","Value":"1"}],"ParamNameToSaveNewRowValue":"NewRow"}]}],"Name":"结束盘点"}