{"Enabled":true,"Triggers":[{"$type":"Forguncy.ServerCommands.Models.PostRequestTrigger, ServerDesignerCommon","Permission":{"AllowRoles":["销售员","销售主管"]},"Parameters":[{"Name":"订单ID"},{"Name":"销售日期"},{"Name":"客户ID"},{"Name":"联系人"},{"Name":"联系电话"},{"Name":"交付日期"},{"Name":"项目ID"},{"Name":"销售员"},{"Name":"销售部门"},{"Name":"总金额"},{"Name":"备注"},{"Type":1,"ArrayParamItems":[{"Name":"物品ID"},{"Name":"数量"},{"Name":"单价"},{"Name":"备注"}],"OnlySendChangedData":true,"PrimaryKeys":["ID"],"Name":"销售详情"}]}],"Commands":[{"$type":"Forguncy.Model.ServerTransactionCommand, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"销售订单表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"销售订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"5f75f3b7-3b33-40d0-bae8-163ad48b035b"},"UpdateValues":[{"ColumnName":"销售日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售日期"}},{"ColumnName":"客户ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=客户ID"}},{"ColumnName":"联系人","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系人"}},{"ColumnName":"联系电话","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=联系电话"}},{"ColumnName":"交货日期","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=交付日期"}},{"ColumnName":"项目ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=项目ID"}},{"ColumnName":"销售员","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售员"}},{"ColumnName":"销售部门","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售部门"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=备注"}},{"ColumnName":"总金额","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=总金额"}}],"ParamNameToSaveNewRowValue":"采购单"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售详情.AddRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"销售订单详情表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"销售订单ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"}},{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"}},{"ColumnName":"销售数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.备注"}}],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售详情.EditRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"销售订单详情表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"销售订单详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.ID"},"Id":"5164801f-090c-4463-b340-23fb7c248e46"},"UpdateValues":[{"ColumnName":"物品ID","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"}},{"ColumnName":"销售数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.数量"}},{"ColumnName":"单价","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.单价"}},{"ColumnName":"备注","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.备注"}}],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=销售详情.DeleteRows"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"销售订单详情表","UpdateType":"delete","ShowConfirm":true,"ConfirmText":"您确定要删除吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"销售订单详情表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.ID"},"Id":"493dff91-2d82-4c9b-a683-8db4e5f0fe20"},"UpdateValues":[],"ParamNameToSaveNewRowValue":"NewRow"}]},{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"新销售详情","TableValue":{"TableName":"销售订单详情表","BindingInfos":[{"BindingInfo":{"TableName":"销售订单详情表","ColumnName":"物品ID"},"ColumnName":"物品ID"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"销售订单详情表","ColumnName":"销售订单ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"6ed36166-b0c2-469c-8e4a-c573d582a815"}},"ID":"51a14e02f43d4ac5a02195e01a28dcaf"},{"$type":"Forguncy.Model.LoopCommand, ServerDesignerCommon","LoopInfo":{"$type":"Forguncy.Model.CountLoopInfo, ServerDesignerCommon","LoopCount":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=新销售详情"},"LoopItemParamName":"Item"},"CommandList":[{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"关联供应商客户与物品","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=客户ID"},"ParamName":"供应商客户ID"},{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=Item.物品ID"},"ParamName":"物品ID"}],"CheckDataValidation":true}]},{"$type":"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon","ParameterName":"订单号","TableValue":{"TableName":"销售订单表","OnlyGetValue":true,"TableValueType":0,"BindingInfos":[{"BindingInfo":{"TableName":"销售订单表","ColumnName":"单号"},"ColumnName":"单号"}],"SqlCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"销售订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单ID"},"Id":"c971f858-d000-4617-ac4e-26148f94dcbb"}},"ID":"5b20f4e12e964e0995219180bba2ab6b"},{"$type":"Forguncy.Model.RequestServerCommand, ServerDesignerCommon","ServerCommandName":"更新销售单出库状态","Parameters":[{"$type":"Forguncy.Model.RequestServerCommandObjectParam, ServerDesignerCommon","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"=订单号"},"ParamName":"订单号"}],"CheckDataValidation":true}]}],"Name":"修改销售单"}